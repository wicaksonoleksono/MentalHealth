<!-- app/templates/admin/consent_tab.html -->
<div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-8 border border-purple-100">
    <h3 class="text-2xl font-semibold text-gray-900 mb-4 flex items-center">
        <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center mr-4">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
        </div>
        Konfigurasi Formulir Persetujuan
    </h3>
    <p class="text-gray-600 mb-8">Konfigurasikan formulir persetujuan yang dilihat pasien sebelum memulai penilaian.</p>
    
    <div class="space-y-6">
        <!-- Consent Form Text -->
        <div>
            <label class="block text-sm font-medium text-gray-700 mb-3">Teks Formulir Persetujuan</label>
            <div class="relative">
                <textarea name="consent_form_text" rows="20"
                    class="w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200 resize-none shadow-sm"
                    placeholder="Masukkan teks formulir persetujuan Anda di sini...">{{ settings_data.consent_form_text or 'PERSETUJUAN UNTUK BERPARTISIPASI DALAM PENILAIAN KESEHATAN MENTAL\n\nSaya memahami bahwa saya diminta untuk berpartisipasi dalam penilaian kesehatan mental yang mencakup:\n• Pengisian kuesioner terstandarisasi (PHQ-9)\n• Partisipasi dalam percakapan berbantuan AI mengenai kesehatan mental saya\n• Perekaman audio/video opsional selama penilaian untuk keperluan penelitian\n\nSaya memahami bahwa:\n• Partisipasi saya bersifat sukarela dan saya dapat mengundurkan diri kapan saja\n• Jawaban saya akan dijaga kerahasiaannya dan hanya digunakan untuk keperluan penelitian\n• Data yang dikumpulkan dapat digunakan dalam bentuk agregat untuk publikasi penelitian\n• Jika saya menyatakan pikiran untuk mencelakai diri sendiri, sumber daya yang sesuai akan diberikan\n• Penilaian ini bukan pengganti perawatan profesional kesehatan mental\n\nSaya memberikan persetujuan untuk berpartisipasi dalam penelitian ini dan memahami hak-hak saya seperti yang dijelaskan di atas.\n\nDengan mengklik \"Saya Setuju\" di bawah, saya menunjukkan persetujuan yang diinformasikan untuk berpartisipasi.' }}</textarea>
                <div class="absolute bottom-3 right-3 text-xs text-gray-400"
                     x-data="{ count: 0 }"
                     x-init="count = $el.parentElement.querySelector('textarea').value.length"
                     x-text="count + ' karakter'">
                </div>
            </div>
            
            <div class="mt-4 bg-purple-50 border border-purple-200 rounded-lg p-4">
                <div class="flex">
                    <svg class="w-5 h-5 text-purple-500 mt-0.5 mr-3" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                    </svg>
                    <div class="text-sm text-purple-700">
                        <strong>Catatan Hukum:</strong> Pastikan formulir persetujuan Anda mematuhi undang-undang privasi setempat dan persyaratan dewan peninjau institusional. Sertakan informasi tentang pengumpulan data, penyimpanan, dan hak-hak peserta.
                    </div>
                </div>
            </div>
        </div>

        <!-- Consent Form Preview -->
        <div class="bg-white rounded-lg border border-purple-200 p-6">
            <h4 class="font-medium text-gray-900 mb-4">Pratinjau Formulir Persetujuan</h4>
            <div class="bg-gray-50 rounded-lg p-4 max-h-64 overflow-y-auto">
                <div class="text-sm text-gray-700 whitespace-pre-line" 
                     x-data="{ preview: '' }"
                     x-init="preview = document.querySelector('[name=consent_form_text]').value"
                     x-text="preview">
                </div>
            </div>
            <div class="mt-4 text-xs text-gray-500">
                Beginilah tampilan formulir persetujuan bagi pasien. Pastikan semua informasi yang diperlukan disertakan dan bahasanya jelas serta mudah diakses.
            </div>
        </div>

        <!-- Quick Templates -->
        <div class="bg-white rounded-lg border border-purple-200 p-6">
            <h4 class="font-medium text-gray-900 mb-4">Template Cepat</h4>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button type="button" onclick="loadTemplate('research')" 
                        class="text-left p-4 border border-gray-200 rounded-lg hover:border-purple-300 hover:bg-purple-50 transition-colors">
                    <div class="font-medium text-gray-900">Studi Penelitian</div>
                    <div class="text-sm text-gray-600 mt-1">Persetujuan penelitian standar dengan pengungkapan pengumpulan data</div>
                </button>
                <button type="button" onclick="loadTemplate('clinical')" 
                        class="text-left p-4 border border-gray-200 rounded-lg hover:border-purple-300 hover:bg-purple-50 transition-colors">
                    <div class="font-medium text-gray-900">Penilaian Klinis</div>
                    <div class="text-sm text-gray-600 mt-1">Persetujuan pengaturan layanan kesehatan untuk tujuan penilaian</div>
                </button>
            </div>
        </div>
    </div>
</div>

<script>
function loadTemplate(type) {
    const textarea = document.querySelector('[name=consent_form_text]');
    const templates = {
        research: `PERSETUJUAN UNTUK BERPARTISIPASI DALAM PENELITIAN KESEHATAN MENTAL\n\n    Saya memahami bahwa saya diminta untuk berpartisipasi dalam sebuah studi penelitian tentang asesmen kesehatan mental yang mencakup:\n    • Pengisian kuesioner standar (PHQ-9)\n    • Partisipasi dalam percakapan berbantuan AI tentang kesehatan mental saya\n    • Perekaman audio/video opsional selama asesmen untuk tujuan penelitian\n\n    Saya memahami bahwa:\n    • Partisipasi saya bersifat sukarela dan saya dapat mengundurkan diri kapan saja tanpa penalti\n    • Tanggapan saya akan dijaga kerahasiaannya dan hanya digunakan untuk tujuan penelitian\n    • Data yang dikumpulkan dapat digunakan dalam bentuk agregat untuk publikasi ilmiah\n    • Jika saya mengungkapkan pikiran untuk menyakiti diri sendiri, sumber daya yang sesuai akan diberikan\n    • Asesmen ini bukan pengganti perawatan kesehatan mental profesional\n    • Data saya akan disimpan dengan aman dan dimusnahkan setelah periode studi berakhir\n\n    Saya menyetujui untuk berpartisipasi dalam penelitian ini dan memahami hak-hak saya sebagaimana dijelaskan di atas.\n\n    Dengan mengklik "Saya Setuju" di bawah ini, saya menyatakan persetujuan saya untuk berpartisipasi.`,

        clinical: `PERSETUJUAN UNTUK ASESMEN KESEHATAN MENTAL\n\n    Saya memahami bahwa saya akan menjalani asesmen kesehatan mental yang mencakup:\n    • Kuesioner standar tentang kesehatan mental saya\n    • Percakapan dengan asisten AI mengenai kondisi saya saat ini\n    • Kemungkinan perekaman untuk tujuan penjaminan kualitas\n\n    Saya memahami bahwa:\n    • Asesmen ini merupakan bagian dari evaluasi layanan kesehatan saya\n    • Tanggapan saya akan dijaga kerahasiaannya sesuai dengan undang-undang privasi layanan kesehatan\n    • Informasi dapat dibagikan kepada tim layanan kesehatan saya jika diperlukan\n    • Protokol darurat akan dijalankan jika saya mengungkapkan pikiran untuk menyakiti diri sendiri\n    • Saya dapat menghentikan asesmen kapan saja\n\n    Dengan melanjutkan, saya menyetujui asesmen kesehatan mental ini.`
    };

    
    if (templates[type] && confirm('Ganti teks persetujuan saat ini dengan template ini?')) {
        textarea.value = templates[type];
        textarea.dispatchEvent(new Event('input'));
    }
}
</script>